<!DOCTYPE html>
<!--
/*
 * The contents of this file are subject to the terms of the Common Development and
 * Distribution License (the License). You may not use this file except in compliance with the
 * License.
 *
 * You can obtain a copy of the License at legal/CDDLv1.0.txt. See the License for the
 * specific language governing permission and limitations under the License.
 *
 * When distributing Covered Software, include this CDDL Header Notice in each file and include
 * the License file at legal/CDDLv1.0.txt. If applicable, add the following below the CDDL
 * Header, with the fields enclosed by brackets [] replaced by your own identifying
 * information: "Portions Copyrighted [year] [name of copyright owner]".
 *
 * Copyright Â© 2012 ForgeRock AS. All rights reserved.
 */
-->
<html>
<head>
    <title>ForgeRock Common REST Demo</title>
    <link rel="shortcut icon" href="images/favicon.ico" />
    <link rel="stylesheet" href="http://code.jquery.com/ui/1.9.2/themes/base/jquery-ui.css" />
    <script type="text/javascript" src="common.js"></script>
    <script type="text/javascript" src="util.js"></script>
    <script src="http://code.jquery.com/jquery-1.8.3.js"></script>
    <script src="http://code.jquery.com/ui/1.9.2/jquery-ui.js"></script>
    <script type="text/javascript">
        $(function() {
            $( "#tabs" ).tabs();
        });
    </script>
</head>
<body>
<a href="http://commons.forgerock.org/forgerock-rest/json-resource-servlet/"><img
        style="float: right;"
        src="http://forgerock.org/images/ForgeRock-Community-grey-295x50.png"
/></a>
<h1>ForgeRock Common REST Demo</h1>

<div id="tabs">

    <ul>
        <li><a href="#about">About</a></li>
        <li><a href="#prerequisites">Before You Start</a></li>
        <li><a href="#create">Create</a></li>
        <li><a href="#read">Read</a></li>
        <li><a href="#update">Update</a></li>
        <li><a href="#delete">Delete</a></li>
        <li><a href="#patch">Patch</a></li>
        <li><a href="#action">Action</a></li>
        <li><a href="#query">Query</a></li>
    </ul>

    <div id="about">
        <p>
            The ForgeRock common REST API defines seven verbs:
        </p>

        <dl>
            <dt>Create</dt>
            <dd>Add a resource that does not yet exist</dd>

            <dt>Read</dt>
            <dd>Retrieve a single resource</dd>

            <dt>Update</dt>
            <dd>Replace an existing resource</dd>

            <dt>Delete</dt>
            <dd>Remove an existing resource</dd>

            <dt>Patch</dt>
            <dd>Modify part of an existing resource</dd>

            <dt>Action</dt>
            <dd>Perform a predefined action</dd>

            <dt>Query</dt>
            <dd>List a set of resources</dd>
        </dl>

        <p>
            A resource store can use the ForgeRock
            <a href="http://commons.forgerock.org/forgerock-rest/">REST
                libraries</a>
            to expose an API that defines these verbs in the common way.
        </p>

        <p>
            A resource store defines collection endpoints for resources that it
            serves. The default
            <a href="http://commons.forgerock.org/forgerock-rest/json-resource-servlet/"
                    >JSON Resource Servlet</a> defines two collection endpoints,
            <code>/users</code> and <code>/groups</code>.
        </p>

        <p>
            A resource store may extend available actions and queries.
        </p>

        <ul>
            <li>
                <p>
                    A resource store may define additional actions that it allows.
                </p>

                <p>
                    By default, the only actions defined are those corresponding
                    to the other six basic verbs: create, read, update, delete,
                    patch, and query.
                </p>

                <p>
                    The default JSON Resource Servlet defines no additional
                    actions.
                </p>
            </li>
            <li>
                <p>
                    A resource store may further define queries that can be
                    called by their IDs.
                </p>

                <p>
                    The default JSON Resource Servlet defines no queries to be
                    called by ID.
                </p>
            </li>
        </ul>
    </div>

    <div id="prerequisites">
        <p>
            This demo uses the REST API exposed by the JSON Resource Servlet.
        </p>

        <ol>
            <li>
                Download and deploy the JSON Resource Servlet .war under
                <code>http://<i>host</i>:<i>port</i>/json</code>.
            </li>

            <li>
                Deploy this demo as static pages alongside the JSON Resource
                Servlet.
            </li>
        </ol>

        <p>
            This demo provides sample <a href="Users.json" target="_blank">users</a>
            and <a href="Groups.json" target="_blank">groups</a> in JSON format.
        </p>

        <p>
            Provision users and groups with the buttons below. When you click one
            of the buttons, the latest response from the JSON Resource Servlet is
            shown below the buttons.
        </p>

        <button type="button" onclick="provisionUsers('provisioning-log')"
                >Provision Users</button>
        <button type="button" onclick="provisionGroups('provisioning-log')"
                >Provision Groups</button>
        <button type="button"
                onclick="document.getElementById('provisioning-log').innerHTML = ''"
                >Clear Log</button>
        <div id="provisioning-log"></div>
    </div>

    <div id="create">
        <form id="create-user" action="#">
            <h3>Create User</h3>

            <label for="create-mail">Email: </label>
            <input id="create-mail" type="email" required="required" /> *
            <br />

            <label for="create-firstname">First Name: </label>
            <input id="create-firstname" type="text" required="required" /> *
            <br />

            <label for="create-lastname">Last Name: </label>
            <input id="create-lastname" type="text" required="required" /> *
            <br />

            <label for="create-userpassword">Password: </label>
            <input id="create-userpassword" type="password" />
            <br />

            <label for="create-phone">Phone: </label>
            <input id="create-phone" type="tel" />
            <br />

            <label for="create-fax">Fax: </label>
            <input id="create-fax" type="tel" />
            <br />

            <label for="create-room">Room Number: </label>
            <input id="create-room" type="number" />
            <br />

            <label for="create-location">Location: </label>
            <select id="create-location">
                <option>Select Location</option>
                <option value="Cupertino">Cupertino</option>
                <option value="Paris">Paris</option>
                <option value="Santa Clara">Santa Clara</option>
                <option value="Sunnyvale">Sunnyvale</option>
            </select>
            <br />

            <label for="create-homeDirectory">Home Directory:</label>
            <input id="create-homeDirectory" type="text" />
            <br />

            <label for="create-uidNumber">UID Number: </label>
            <input id="create-uidNumber" type="number" />
            <br />

            <label for="create-gidNumber">GID Number: </label>
            <input id="create-gidNumber" type="number" />
            <br />

            <button type="button"
                    onclick="createUser(this.form, 'create-', 'user-log')"
                    >Create</button>
        </form>
        <div id="create-user-log"></div>

        <form id="create-group">
            <h3>Create Group</h3>

            <label for="create-name">Name: </label>
            <input id="create-name" type="text" required="required" /> *
            <br />

            <label for="create-description">Description: </label>
            <input id="create-description" type="text" />
            <br />

            <label for="create-users">Members:</label>
            <select id="create-users" multiple="multiple"
                    onfocus="populateUserList('create-users')"></select>
            <br />

            <button type="button"
                    onclick="createGroup(this.form, 'create-', 'group-log')"
                    >Create</button>
        </form>
        <div id="create-group-log"></div>
    </div>

    <div id="read">
        <form id="read-user">
            <h3>Read User</h3>
            <label for="read-select-user">User to read: </label>
            <select id="read-select-user"
                    onfocus="populateUserList('read-select-user')">
                <option>Select User</option>
            </select>
            <button type="button"
                    onclick="writeUserTable(this.form, 'read-', 'select-user', 'user-table')"
                    >Read</button>
            <br />

            Properties:
            <input id="read-mail" type="checkbox" checked="checked" />
            <label for="read-mail">Email</label>

            <input id="read-fullname" type="checkbox" checked="checked" />
            <label for="read-fullname">Full name</label>

            <input id="read-phone" type="checkbox" />
            <label for="read-phone">Phone number</label>

            <input id="read-all" type="checkbox" />
            <label for="read-all">Everything</label>
        </form>
        <div id="read-user-table"></div>

        <form id="read-group">
            <h3>Read Group</h3>
            <label for="read-select-group">Group to read: </label>
            <select id="read-select-group"
                    onfocus="populateGroupList('read-select-group')">
                <option>Select Group</option>
            </select>

            <button type="button"
                    onclick="writeGroupTable(this.form, 'read-', 'select-group', 'group-table')"
                    >Read</button>
        </form>
        <div id="read-group-table"></div>
    </div>

    <div id="update">
        <form id="update-user">
            <h3>Update User</h3>

            <label for="update-select-user">User to update: </label>
            <select id="update-select-user"
                    onfocus="populateUserList('update-select-user')">
                <option>Select User</option>
            </select>
            <br />

            <button type="button"
                    onclick="selectUserFromList(this.form, 'update-', 'select-user')"
                    >Load</button>
            <br />

            <input id="update-userId" type="hidden" />
            <input id="update-userVersion" type="hidden" />

            <label for="update-mail">Email: </label>
            <input id="update-mail" type="email" readonly="readonly" />
            <br />

            <label for="update-firstname">First Name: </label>
            <input id="update-firstname" type="text" />
            <br />

            <label for="update-lastname">Last Name: </label>
            <input id="update-lastname" type="text" />
            <br />

            <label for="update-userpassword">Password: </label>
            <input id="update-userpassword" type="password" />
            <br />

            <label for="update-phone">Phone: </label>
            <input id="update-phone" type="tel" />
            <br />

            <label for="update-fax">Fax: </label>
            <input id="update-fax" type="tel" />
            <br />

            <label for="update-room">Room Number: </label>
            <input id="update-room" type="number" />
            <br />

            <label for="update-location">Location: </label>
            <select id="update-location">
                <option>Select Location</option>
                <option value="Cupertino">Cupertino</option>
                <option value="Paris">Paris</option>
                <option value="Santa Clara">Santa Clara</option>
                <option value="Sunnyvale">Sunnyvale</option>
            </select>
            <br />

            <label for="update-homeDirectory">Home Directory:</label>
            <input id="update-homeDirectory" type="text" />
            <br />

            <label for="update-uidNumber">UID Number: </label>
            <input id="update-uidNumber" type="number" />
            <br />

            <label for="update-gidNumber">GID Number: </label>
            <input id="update-gidNumber" type="number" />
            <br />

            <button type="button"
                    onclick="updateUser(this.form, 'update-', 'user-log')"
                    >Update</button>
        </form>
        <div id="update-user-log"></div>

        <form id="update-group">
            <h3>Update Group</h3>

            <label for="update-select-group">Group to update: </label>
            <select id="update-select-group"
                    onfocus="populateGroupList('update-select-group')">
                <option>Select Group</option>
            </select>
            <br />

            <button type="button"
                    onclick="selectGroupFromList(this.form, 'update-', 'select-group', 'members')"
                    >Load</button>
            <br />

            <input id="update-groupId" type="hidden" />
            <input id="update-groupVersion" type="hidden" />

            <label for="update-name">Name: </label>
            <input id="update-name" type="text" readonly="readonly" />
            <br />

            <label for="update-description">Description: </label>
            <input id="update-description" type="text" />
            <br />

            <label for="update-members">Members: </label>
            <select id="update-members" multiple="multiple"></select>
            <br />

            <button type="button"
                    onclick="updateGroup(this.form, 'update-', 'group-log')"
                    >Update</button>
        </form>
        <div id="update-group-log"></div>
    </div>

    <div id="delete">
        <form id="delete-user-by-uid" action="#">
            <h3>Delete User By ID</h3>

            <label>Lookup user IDs: </label>
            <button type="button" onclick="listUsersByUid('delete-user-log')"
                    >List User IDs</button>
            <button type="button"
                    onclick="document.getElementById('delete-user-log').innerHTML = ''"
                    >Clear List</button>
            <br />
            <label for="delete-uid">Specify user ID: </label>
            <input id="delete-uid" type="text" value=""/>
            <button type="button"
                    onclick="deleteUser(this.form, 'delete-', 'user-log')"
                    >Delete</button>
        </form>

        <form id="delete-user-from-list" action="#">
            <h3>Delete User From List</h3>

            <label for="delete-select-user">User: </label>
            <select id="delete-select-user"
                    onfocus="populateUserList('delete-select-user')">
                <option>Select User</option>
            </select>
            <button type="button"
                    onclick="deleteUserFromList('delete-select-user', 'delete-user-log')"
                    >Delete</button>
        </form>
        <div id="delete-user-log"></div>

        <p>
            Delete a group with one of the following forms.
        </p>
        <form id="delete-group-by-name" action="#">
            <h3>Delete Group By ID</h3>

            <label>Lookup group names: </label>
            <button type="button" onclick="listGroupsByName('delete-group-log')"
                    >List Groups</button>
            <button type="button"
                    onclick="document.getElementById('delete-group-log').innerHTML = ''"
                    >Clear List</button>
            <br />
            <label for="delete-name">Specify group name: </label>
            <input id="delete-name" type="text" value="" />
            <button type="button"
                    onclick="deleteGroup(this.form, 'delete-', 'group-log')"
                    >Delete</button>
        </form>

        <form id="delete-group-from-list" action="#">
            <h3>Delete Group From List</h3>

            <label for="delete-select-group">Group: </label>
            <select id="delete-select-group"
                    onfocus="populateGroupList('delete-select-group')">
                <option>Select Group</option>
            </select>
            <button type="button"
                    onclick="deleteGroupFromList('delete-select-group', 'delete-group-log')"
                    >Delete</button>
        </form>
        <div id="delete-group-log"></div>
    </div>

    <div id="patch">
        <p>
            TODO: Demonstrate when patch is finished. See
            <a href="https://bugster.forgerock.org/jira/browse/CREST-3">CREST-3</a>.
        </p>
    </div>

    <div id="action">
        <p>
            The default JSON Resource Servlet implements only the actions
            corresponding to the other six basic verbs: create, read, update,
            delete, patch, and query.
        </p>

        <p>
            In other words, you can call those verbs as actions with an HTTP POST.
            For example, to create a user with an ID assigned by the resource store,
            POST the JSON representation of the user to
            <code>/users?_action=create</code>.
        </p>
    </div>

    <div id="query">
        <form id="query-users">
            <h3>Query Users</h3>
            Retrieve properties:
            <input id="query-mail" type="checkbox" checked="checked" />
            <label for="query-mail">Email</label>

            <input id="query-fullname" type="checkbox" checked="checked" />
            <label for="query-fullname">Full name</label>

            <input id="query-phone" type="checkbox" />
            <label for="query-phone">Phone number</label>

            <input id="query-all" type="checkbox" />
            <label for="query-all">Everything</label>
            <br />

            <button type="button"
                    onclick="writeUsersTable(this.form, 'query-', 'table')"
                    >Query Users</button>
        </form>

        <form id="query-groups">
            <h3>Query Groups</h3>
            Retrieve properties:
            <input id="query-name" type="checkbox" checked="checked" />
            <label for="query-name">Name</label>

            <input id="query-members" type="checkbox" checked="checked" />
            <label for="query-members">Members</label>

            <input id="query-description" type="checkbox" />
            <label for="query-description">Description</label>
            <br />

            <button type="button"
                    onclick="writeGroupsTable(this.form, 'query-', 'table')"
                    >Query Groups</button>
        </form>

        <div id="query-table"></div>

        <pre>
            TODO:
            // _filter=FILTER, where the filter is TBD
            // _sortKeys=[+-]FIELD,..., where + is encoded as %2B
            // _pagedResultsCookie=STRING
            // _pageSize=INTEGER
            // _queryId=ID to trigger a stored query, also takes arg1=value1 to argN=valueN
        </pre>
    </div>

</div>
</body>
</html>